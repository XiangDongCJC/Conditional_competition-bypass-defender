# 免责声明

**本文档所提供的信息旨在帮助网络安全专业人员更好地理解并维护他们负责的网站和服务器等系统。我们鼓励在获得适当授权的情况下使用这些信息。请注意，任何未经授权的使用或由此产生的直接或间接后果和损失，均由使用者自行承担。我们提供的资源和工具仅供学习和研究之用，我们不鼓励也不支持任何非法活动。"**

**"我们创建这个社区是为了促进技术交流和知识分享。我们希望每位成员都能在遵守法律法规的前提下参与讨论和学习。如果使用本文档中的信息导致任何直接或间接的后果和损失，我们提醒您，这将由您个人承担。我们不承担由此产生的任何责任。如果有任何内容侵犯了您的权益，请随时告知我们，我们将立即采取行动并表示诚挚的歉意。我们感谢您的理解和支持。**

# 前言

**条件竞争（Conditional  competition），是一种利用了时间延迟而达到将恶意代码执行前将杀软进行致盲的一种手段，以规避安全检测，提高恶意代码执行的隐蔽性和稳定性**

# 条件竞争特点

### 特点：AV致盲

**常用于比较极端的环境下，比如规定bypass defender这一种情况下使用，亦可搭配bypass 某绒**

# 实现原理探究

### 思路：在Windows Defender 查杀之前运行程序，该程序会将自己和他所释放的文件加入到Windows Defender 的排除项（信任区）

### 实现思路

​	*通过GetModuleFileName获取该程序所在的位置（绝对路径）*

​	*使用无界面化的cmd执行powershell -Command Add-MpPreference -ExclusionPath <该程序的文件的绝对路径>  向Defender中加入这个的排除项*

​	*然后继续使用无界面化的cmd执行powershell -Command Set-MpPreference -SubmitSamplesConsent NeverSend  先*Defender中关闭自动提交样本

​	*然后使用分离加载shellcode 然后进行执行上线，这里其实就已经绕过某绒的查杀了，如果想要更加免杀一些，可以使用动态Api调用*

### 在具体实现上，还需要考虑以下问题：

​	**1.程序不能立即被查杀**

​		*定期修改程序的一些函数，或者进行Hook一些函数和将用到的win32api都进行动态调用，亦或者打上一个加密的压缩包就完事了*

​	**2.程序不能通过游览器进行下载**

​		*如果想通过浏览器可以进行下载的话，你需要在这个程序打上一个加密的压缩包*

​	**3.如果有其他的AV存在的话，不确定可以进行免杀（除某绒），这个本身就是针对Windows Defender，某绒只是比较好bypass**

